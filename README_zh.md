# AI数字人平台 (commagents)

一个用于创建、管理和运营数字人的综合AI平台，支持内容生成和直播流媒体。

![架构图](./images/arch.jpg)

## 项目概述

**AI数字人平台**是一个模块化系统，能够创建和运营智能数字人，具备自主内容生成、实时交互和多平台发布能力。该平台基于MetaGPT的多智能体框架，协调涉及内容创作、数字人管理和生态系统集成的复杂工作流程。

**足球直播数字人(LiveFootballAvatar)**作为初始示例实现，展示了多个专业智能体生成实时足球解说的能力。

## 架构

### 1. 数字人制造车间

#### 直播数字人智能体
- 知识库管理和动态知识注入
- 个性化配置和行为定制
- 实时上下文感知和适应

#### 通用数字人组装
- 数字人配置的后台管理界面
- 可定制的数字人个性、声音和行为
- 可扩展的数字人部署和管理

#### 数字人内容生成
- 从"一句话"到完整内容生成
- 基于LLM的自然语言处理
- 上下文感知响应生成

#### 数字人任务编排
- n8n工作流集成的自动化任务
- 事件驱动的动作和调度
- 多数字人协调和交互

### 2. 内容工厂

#### 内容导入智能体
- API和MCP协议集成的内容获取
- WebSurfer和WebCrawler工具的自主内容发现
- 多源内容聚合和处理

#### 文案生成智能体
- **多源内容生成**：
  - 单句提示扩展
  - 内容再加工和微创新
  - IP风格内容转换
- 基于LLM + 外部工具 + n8n工作流的工具增强生成

#### 视频制作一条龙智能体
- 端到端自动化视频创建
- 脚本生成和视频处理
- 与外部视频工具和服务集成

### 3. 生态平台接入

#### 接入发布一条龙智能体
- 多平台内容分发
- 通过n8n的自动化发布工作流
- 平台特定优化和格式化

### 4. 数据分析
- 直播数字人性能指标和分析
- 用户互动跟踪和分析
- 内容性能优化洞察

## 核心组件

### 当前实现（足球直播数字人）

#### 智能体角色

**实况解说员** (`agents/playbyplay_commentator.py`)
- 激情的足球实况解说
- 比赛事件的生动有力的解说
- 实时事件处理和响应生成

**战术分析师** (`agents/tactical_analyst.py`)
- 阵型和战术的战略分析
- 详细的战术解释和洞察
- 阵型和策略解说

**节目主持人** (`agents/show_host.py`)
- 讨论调节和流程管理
- 解说环节间的平滑过渡
- 观众参与和互动

#### 事件处理架构

```
[实时比赛数据] ──▶ [n8n Webhook] ──▶ [MCP / MetaGPT智能体]
                                     │
                                     │  [生成解说]
                                     │  
                       ┌─────────────┴─────────────┐─────────────────────┐
                       ▼                           ▼                     ▼
             [解说员智能体]                   [分析师智能体]         [主持人智能体]
                       │                           │                     │
                       └────────┬───────────────┬──┘─────────────────────┐
                                ▼               ▼                        ▼
                                         [触发数字人API]
                                                ▼
       [解说员数字人语音输出]     [分析师数字人]      [主持人数字人]
```

### 集成点

#### 数字人API集成
```json
POST /speak
{
  "text": "姆巴佩的这一脚射门太精彩了！",
  "emotion": "excited", 
  "language": "Chinese"
}
```

#### n8n工作流
```
[比赛更新Webhook] → [LLM解说] → [HTTP: speak_avatar] → [DUIX/Akool API]
```

#### MCP服务器集成
- 服务器URL: `http://localhost:8080`
- 工具: `process_match_event`, `trigger_avatar`
- 实时函数调用管理

## 快速开始

### 前置条件
- Python 3.8+
- MetaGPT框架
- n8n工作流自动化
- 数字人API服务 (DUIX/SenseAvatar)

### 配置
1. 复制 `config/config2.example.yaml` 到 `config/config2.yaml`
2. 更新API密钥和端点
3. 在 `config/football_avatar.yaml` 中配置数字人设置

### 运行示例
```bash
# 运行足球解说系统
python agents/football_commentary_team.py

# 运行测试
python test_commentary.py
```

## 技术栈

- **框架**: MetaGPT多智能体系统
- **语言**: Python 3.8+
- **工作流**: n8n自动化平台
- **集成**: MCP (模型上下文协议)
- **AI/LLM**: OpenAI GPT-4, Azure OpenAI和其他LLM提供商
- **数字人**: DUIX, SenseAvatar, Akool APIs

## 许可证

本项目根据LICENSE文件中指定的条款授权。